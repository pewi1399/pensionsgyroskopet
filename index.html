<!DOCTYPE html>
<meta charset="utf-8">

<style>
    .axis { font: 10px sans-serif; -webkit-user-select: none; -moz-user-select: none; user-select: none; }
    .axis   .domain { fill: none; stroke: #000; stroke-opacity: .3; stroke-width: 10px; stroke-linecap: round; }
    .axis   .halo   { fill: none; stroke: #ddd; stroke-width: 8px;  stroke-linecap: round; }
    .slider .handle { fill: #fff; stroke: #000; stroke-opacity: .5; stroke-width: 1.25px; pointer-events: none; }

    .Paxis { font: 10px sans-serif; -webkit-user-select: none; -moz-user-select: none; user-select: none; }
    .Paxis path {
            fill: none;
            stroke: black;
            stroke-width: 1;
            shape-rendering: crispEdges;
          }



    path {
    stroke: steelblue;
    stroke-width: 2;
    fill: none;
}

    .div1 {
        width: 600px;
        border: 5px solid gray;
        padding: 25px;
        margin: auto;
        font-size:10pt;
        font-family:Arial;

    }

    .MyInput1 {
      position: absolute;
      display: block;
      float: left;
      padding: 1px;
      left: 35px;
      top: 114px;
      -webkit-appearance: checkbox; /* Chrome, Safari, Opera */
      -moz-appearance: checkbox;    /* Firefox */
      -ms-appearance: checkbox;     /* not currently supported */
    }

    .MyInput2 {
      position: absolute;
      display: block;
      float: left;
      padding: 1px;
      left: 35px;
      top: 249px;
      -webkit-appearance: checkbox; /* Chrome, Safari, Opera */
      -moz-appearance: checkbox;    /* Firefox */
      -ms-appearance: checkbox;     /* not currently supported */
    }

    .MyInput3 {
      position: absolute;
      display: block;
      float: left;
      padding: 1px;
      left: 35px;
      top: 385px;
      -webkit-appearance: checkbox; /* Chrome, Safari, Opera */
      -moz-appearance: checkbox;    /* Firefox */
      -ms-appearance: checkbox;     /* not currently supported */
    }

    div.content
{
font-size:12pt;
font-family:Arial;
font-weight:bold;
font-style:italic;
color:#23238e;
}


.ticks {
  font: 10px sans-serif;
}

.track,
.track-inset,
.track-overlay {
  stroke-linecap: round;
}

.track {
  stroke: #000;
  stroke-opacity: 0.3;
  stroke-width: 7px;
}

.track-inset {
  stroke: #ddd;
  stroke-width: 8px;
}

.track-overlay {
  pointer-events: stroke;
  stroke-width: 30px;
  cursor: crosshair;
  opacity: 0;
}

.handle {
  fill: #fff;
  stroke: #000;
  stroke-opacity: 0.5;
  stroke-width: 1.25px;
}



</style>

<body>


<form name = "gg">
<div class = "div1" style="display: inline-block">
    <div id="x1">Pensionsår<sub>x</sub><input class = "MyInput1" type="radio" name="choice" value="pensionar" checked><br></div><br>
    <div id="x2">Behållning<sub>y</sub><input class = "MyInput2" type="radio" name="choice" value="behallning"><br></div><br>
    <div id="x3">Sparande<sub>z</sub><input class = "MyInput3" type="radio" name="choice" value="sparande"></div><br>
    <div id="x4"><sub></sub></div><br>
</div>


</form>


    <script src="src/d3v4/d3.min.js"></script>
    <script src="slider2.js"></script>
    <!--<script src="plot.js"></script>-->
    <script src="src/jquery-3.1.1.min.js"></script>
    <script>


var alpha = 25
var beta = 600000

//------------------------------------------------------------------------------

        function pension(src, y, z)
        {
          // maxvärde 67 år
          // minvärde 55 år
            var unlocked = $('input[name=choice]:checked').val()
            var pensionsar = src.value();

            if(pensionsar > 67)
            {
                var a = 0
                y.value(a);
                z.value(a);
            }
            else if ( unlocked ==  "behallning" )
            {
                var x =  src.value()///100;
                y.value(
                  z.value()*(x - alpha) / (67 - x + 10)
                );
            }
            else if ( unlocked ==  "sparande" )
            {
                var x =  src.value()///100;
                z.value(
                  y.value()*(67 - x +10)/(x - alpha)
                );

            }
            redraw()
        }

//------------------------------------------------------------------------------

        function behallning(src,x,z)
        {
          // maxvärde nuvarande ink /12
          var unlocked = $('input[name=choice]:checked').val()
          var behallning = src.value();

          if(behallning > 500*1000)
          {
              var a = 0
              x.value(a);
              z.value(a);
          }
          else if ( unlocked ==  "pensionar" )
          {
              var y =  behallning///100;
              x.value(
                (z.value()*alpha + 67*y + 10*y) / (z.value() + y)
              );
          }
          else if ( unlocked ==  "sparande" )
          {
              var y =  behallning///100;
              z.value(
                y*(67 - x.value() +10)/(x.value() - alpha)
              );

          }
          redraw()
        }

//------------------------------------------------------------------------------

        function sparande(src,x,y)
        {
          var unlocked = $('input[name=choice]:checked').val()
          var sparande = src.value();

          if(sparande > 50*1000)
          {
              var a = 0
              x.value(a);
              y.value(a);
          }
          else if ( unlocked ==  "pensionar" )
          {
              var z =  sparande;//100;
              console.log((z * alpha + 67*y.value() + 10*y.value()) / (z + y.value()));
              x.value(
                (z * alpha + 67*y.value() + 10*y.value()) / (z + y.value())
              );
          }
          else if ( unlocked ==  "behallning" )
          {
              var z =  sparande///100;
              console.log(z * (x.value() - alpha) / (67 - x.value() + 10));
              y.value(
                z * (x.value() - alpha) / (67 - x.value() + 10)
              );
          }
          redraw()
        }

//------------------------------------------------------------------------------

        var s1 = slider2(55,67), s2 = slider2(0,50*1000), s3 = slider2(0,50*1000);
        //s1.value(55);
        //s2.value(10000);
        //s3.value(5000);

        s1.callback(function(){

          pension(s1,s2,s3);}
        )
        s2.callback(function(){behallning(s2,s1,s3);})
        s3.callback(function(){sparande(s3,s1,s2);})

        var slider11 = d3.select("#x1").append("svg").call(s1);
        var slider22 = d3.select("#x2").append("svg").call(s2);
        var slider33 = d3.select("#x3").append("svg").call(s3);

    </script>
    <div style="display: inline-block">

</div>
</body>
